#!/bin/bash
# PowerShell包装器脚本

# 可能的PowerShell路径
PWSH_PATHS=(
    "/c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe"
    "/c/Program Files/PowerShell/7/pwsh.exe"
    "powershell"
    "pwsh"
)

# 查找并执行PowerShell
for path in "${PWSH_PATHS[@]}"; do
    if command -v "$path" >/dev/null 2>&1 || [[ -f "$path" ]]; then
        exec "$path" "$@"
        exit $?
    fi
done

echo "错误: 未找到PowerShell，请确保已正确安装"
exit 1
